<script>
  $(document).ready(function() {
    var row = 0,
      col = 0,
      ncol = 0;
    var sum;
   
    // sum by col
    for (col = 1; col < ncol + 1; col++) {
      console.log("column: " + col);
      sum = 0;
      $("tr").each(function(rowindex) {
        $(this).find("td:nth-child(" + col + ")").each(function(rowindex) {
          newval = $(this).find("input").val();
          console.log(newval);
          if (isNaN(newval)) {
            $(this).html(sum);
          } else {
            sum += parseInt(newval);
          }
        });
      });
    }
  });
  </script>
  


<div class="row">
   
  <div class="container-fluid">
    
      <h2>Project Information Details</h2>
    <div class="panel panel-default">
      
      <div class="panel-heading">Search Project Information Details
        <!-- <button *ngIf="role" type="button" class="btn btn-success fa fa-plus-circle" data-toggle="modal" data-target="#addpoform" style="float:right"  (click)="searchpodata()">
          &nbsp;&nbsp;Add</button> -->
          
        </div> 
        <div class="panel-body">
          <div>
            <div id="addpoform" class="modal fade" role="dialog" tabindex="-1">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title"></h4>
                  </div>
                 
                </div>
              </div>
            </div>
            <div class="col-md-12" *ngIf="errtable">
              <div class="alert alert-danger alert-dismissible">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                {{errtable}}
              </div>
            </div>
            <form [formGroup]="poapprovalform">
              <div class="form-group">
                <div class="row">
                  <div class="col-md-6">
                    <label>Account Category</label>
                    <select class="form-control"[formControl]="poapprovalform.controls['accountcategory']" (change)="search_account_category($event.target.value)" >
                      <option value="" disabled selected hidden style="color:#a4b2ba;" >Select Account Category</option>
                      <option *ngFor="let category of categories" [value]=category >
                        {{category}}
                      
                    </select>
                   
                  </div>

                  <div class="col-md-6">
                    <label>Account Name</label>
                    <select class="form-control" [formControl]="poapprovalform.controls['accountname']" (change)="get_all_project_infolist($event.target.value)">
                      <option value="" disabled selected hidden style="color:#a4b2ba;">Select Account Category</option>
                      <option *ngFor="let acname of acnames" [value]=acname.accountName>{{acname.accountName}}</option>
                    </select>
                   
                  </div>

                  <div class="col-md-6">
                    <label>Project Name</label>
                    <input type="text"  class="form-control" placeholder="Project Name..."  formControlName="proname"  [(ngModel)]="project_name_data">
                    <!-- <input type="text" class="form-control" [formControl]="poapprovalform.controls['proname']" /> -->
                  </div>

                  <div class="col-md-3">
                    <label>Project Type</label>
                    <select class="form-control" [formControl]="poapprovalform.controls['protype']" selected>
                      <option value="" disabled selected>Select Project Type</option>
                      <option *ngFor="let acnam of project_types " [value]='acnam.code'>{{acnam.code}}</option>
                    </select>
                  </div>
                 
                  <div class="col-md-3">
                      <label>Project Year & Month</label>
                     
                      <select class="form-control" [formControl]="poapprovalform.controls['modalpo_year_month']">
                      <option value="" disabled selected hidden style="color:#a4b2ba;">Select Year & Month</option>
                      <option *ngFor="let month_year of project_year_monthz" value={{month_year}}>{{month_year}}</option>
                 
                    </select>
                  
                  </div> 
               
                </div>
                
                
              </div>
              
              <div class="text-center col-md-12">
                <button [disabled]="poapprovalform.invalid" class="btn btn-primary col-md-offset-3 col-md-2" type="submit" (click)="search_all_project_info(poapprovalform.value)">Search</button>
                <button [disabled]="poapprovalform.invalid" class="btn btn-danger col-md-offset-2 col-md-2" type="reset">Cancel</button>
              </div>
              
            </form>
           

            
          </div>
        </div>
      </div>
     
      <div class="panel panel-default" *ngIf="account_all_project_info">
        <div class="panel-body">
          
        
            <div class="table-responsive">          
                <table class="display row-border hover modaldatatable" style="width:100%" datatable [dtOptions]="dtOptions">
                  <thead  scope="row">
                    <tr  scope="row">
                      <th>SNO</th>
                      <th >Account
                        </th>
                      <th >Customer Name
                        </th>
                      <th >PID
                        </th>
                      <th >Quote
                        </th>
                      <th > Contract
                        </th>
                      <th>Start Date
                        </th>
                      <th>End Date
                        </th>
                      <th >Detailed Info</th>
                                        
                       
                    </tr>
                    
                  </thead>
                  <tbody>
                    <!-- <tr> -->
                        <tr *ngFor="let emplist of account_all_project_info; index as i">
                        <td>{{i+1}}</td>
                        <td>{{emplist.accountName}}</td>
                        <td>{{emplist.customerName}}</td>
                        <td>{{emplist.pid}}</td>
                        <td>{{emplist.quote}}</td>
                        <td>{{emplist.contract}}</td>
                        <td>{{emplist.projectStartDate}}</td>
                        <td>{{emplist.projectEndDate}}</td>
                        <td> <button *ngIf="role" type="button" class="btn btn-info btn-sm fa fa-expand" data-toggle="modal" data-target="#addpoformexpand" (click)='[setupdatemodel(emplist),search_account_category(emplist.accountCategory)]'></button>&nbsp;
                          <button type="button" class="btn btn-success" routerLink="/projectinfo-monthly" data-dismiss="modal">Monthly Info</button>
                       
                          
                    </tr>
                   
                  </tbody>
                 
                </table>
              </div>
             
           <div id="addpoformexpand" class="modal fade" role="dialog" tabindex="-1">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">

                   
                    <h4 class="modal-title">Detail Project Information  <i class="fa fa-close pull-right" data-dismiss="modal"  (click)='close()'></i></h4>
                   
                  </div>
                  <form [formGroup]="detailexpand">
                    <div class="modal-body">
                      <div class="form-group">
                      
                      <div class="form-group col-md-4">
                          <label>Account Category</label>
                          <input type="text" class="form-control"   [formControl]="detailexpand.controls['updaccountcat']" disabled/>
                          
                          <!-- <small class="text-danger" *ngIf="detailexpand.controls.updaccountcat.errors && (detailexpand.controls.updaccountcat.dirty || detailexpand.controls.updaccountcat.touched) && !detailexpand.controls.updaccountcat.valid">
                            <span *ngIf="detailexpand.controls.updaccountcat.errors.required">Account Category is required</span>
                          </small> -->
                        </div>
                                  <div class="form-group col-md-3">
                                    <label>Account Name</label>
                                    <input type="text" class="form-control" [formControl]="detailexpand.controls['updaccountname']" disabled  />
                                   
                                  </div>

                      <div class="form-group col-md-4">
                        <label>Project Name</label>
                        <input type="text" class="form-control" [formControl]="detailexpand.controls['updprojectname']" />
<!--                       
                        <small class="text-danger" *ngIf="detailexpand.controls.updaccountname.errors && (detailexpand.controls.updaccountname.dirty || detailexpand.controls.updaccountname.touched) && !detailexpand.controls.updaccountname.valid">
                          <span *ngIf="detailexpand.controls.updaccountname.errors.required">Project Name is required</span>
                        </small> -->
                        </div>
                        
                        <div class="form-group  col-md-4">
                            <label>Year & Month</label>
                            <input type="text" class="form-control" value="Jan-2019" disabled/>
                          
                        </div>

                        
                        
                       
                        
                       <div class="form-group col-md-3">
                          <label>Customer Name</label>
                          <input type="text" class="form-control"  [formControl]="detailexpand.controls['updcustname']" disabled/>
                        </div>
                        
                        <div class="form-group col-md-2">
                         <label>Project Start Date</label>
                         <input type="text" class="form-control"  [formControl]="detailexpand.controls['updprojectsdate']" disabled/>
                        
                       </div>
                        
                        <div class="form-group col-md-2">
                          <label>Project End Date</label>
                          <input type="text" class="form-control"  [formControl]="detailexpand.controls['updprojectedate']"  placeholder="DD/MMM/YYYY"  disabled/>
                          
                        </div>
                        
                        <div class="form-group col-md-2">
                          <label>Project Billing Currency</label>
                          <input type="text" class="form-control"   placeholder="Project Billing Currency" disabled/>
                          
                        </div>
                        <div class="form-group  col-md-3">
                            <label>Project Year & Month</label>
                           
                            <select class="form-control" [formControl]="detailexpand.controls['modalpo_year_month']">
                            <option value="" disabled selected hidden style="color:#a4b2ba;">Select Year & Month</option>
                            <option *ngFor="let month_years of project_year_month" value={{month_years}}>{{month_years}}</option>
                       
                          </select>
                        
                        </div> 
                        <!-- <div class="form-group  col-md-3">
                            <label>Project Associates</label>
                           
                        </div> -->
                      
                      
                        <div class="form-group col-md-3 get_input_search">
                            <label>&nbsp;&nbsp;</label>
                            <button type="button" class="btn-primary" (click)="searchassociates(detailexpand.value)">Associates Search</button>
                        </div>
                        <div class="panel panel-default">
					
                            <div class="panel-body">
                        <div class="form-group">
                           
                            <div class="table-responsive">          
                                <table class="table table-striped table-bordered wrap"  style="width:100%" datatable [dtOptions]="dtOptions">
                                  <thead>
                                    <tr>
                                      <th>SNO</th>
                                      <th>Account
                                        </th>
                                      <th>Customer Name
                                        </th>
                                      <th>PID
                                        </th>
                                      <th>Quote
                                        </th>
                                      <th>Contract
                                        </th>
                                      <th>Start Date
                                        </th>
                                      <th>End Date
                                        </th>
                                      
                                         <!-- <th>Detailed Info</th> -->
                                             
                                         <th>Days Left
</th>
                                         <th>PO#

</th>
                                         <th>Balance (Final)

</th>
                                         <th>Avg. Billing

</th>
                                         <th>Months Consmd.

</th>
                                    </tr>
                                    
                                  </thead>
                                  <tbody *ngIf="a">
                                    <!-- <tr> -->
                                      <tr>
                                        <td>1</td>
                                        <td>{{a.accountName}}</td>
                                        <!-- <td>{{a.acoountName}}</td> -->
                                        <td>{{a.customerName}}</td>
                                        <td>{{a.pid}}</td>
                                        <td>{{a.quote}}</td>
                                        <td>{{a.contract}}</td>
                                        <td>{{a.projectStartDate}}</td>
                                        <td>{{a.projectEndDate}}</td>
                                        <td></td>
                                        <td>{{a.po}}</td>
                                        <td>{{a.pid}}</td>
                                        <td></td>
                                        <td></td>
                                        
                                       
                                      
                                       `
                                    
                                    </tr>
                                   
                                  </tbody>
                                  
                                </table>
                                <div class="col-md-12" *ngIf="error">
                                    <div class="alert alert-danger alert-dismissible">
                                      <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                                      {{error}}
                                    </div>
                                  </div>
                              </div>
                        </div>
                            </div>
                          </div>
                         
                        <div class="panel panel-default" *ngIf="associateslist!=undefined">
					
                          <div class="panel-body">
                        <div class="form-group">
                          <div class="table-responsive">          
                              <table  class="table table-striped table-bordered wrap"  style="width:100%" datatable [dtOptions]="dtOptions">
                                <thead>
                                  <tr>
                                    <th>SNO</th>
                                    <th>GID
                                      </th>
                                    <th>Associate Name
                                      </th>
                                    <th>Asso. Start Date

                                      </th>
                                    <th>Asso. Last Date

                                      </th>
                                    <th>Releasing in

                                      </th>
                                    <th>Band

                                      </th>
                                    <th>UOM

                                      </th>
                                    
                                      
                                           
                                       <th>Rates

</th>
    
                                  </tr>
                                  
                                </thead>
                                <tbody>
                                  <!-- <tr> -->
                                      <tr *ngFor="let emplistes of associateslist; index as i">
                                      <td>{{i+1}}</td>
                                      <td>{{emplistes.associateId}}</td>
                                      <td>{{emplistes.associateName}}</td>
                                      <td>{{emplistes.associateStartDate}}</td>
                                      <td>{{emplistes.associateEndDate}}</td>
                                      <td>{{emplistes.releasedate}}</td>
                                      <td>{{emplistes.band}}</td>
                                      <td>{{emplistes.uof}}</td>
                                     
                                      <td>{{emplistes.rates}}</td>
                                     
                                    
                                     
                                  
                                  </tr>
                                 
                                </tbody>
                                
                              </table>
                            </div>
                      </div>
                    </div>
                  </div>
                      </div>
                      <div class="modal-footer">
                        <!-- <button type="button" [disabled]="detailexpand.invalid" class="btn btn-primary" data-create="modal">Update</button> -->
                        <button type="button" class="btn btn-danger" style=float:center data-dismiss="modal" (click)='close()' >Close</button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div> 
               

        </div>             
      </div>
    </div>
    